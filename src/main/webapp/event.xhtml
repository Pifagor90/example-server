<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
</h:head>
<h:body>
    <f:view>
        <!--TODO: add facelet footer, header, css etc.-->
        <h1>Add Event</h1>
        <h:form>
            <table>
                <tr>
                    <td><label>Event state</label></td>
                    <td>
                        <h:selectOneMenu value="#{event.eventState}">
                            <f:selectItems value="#{eventStates.eventStates}"/>
                        </h:selectOneMenu>
                    </td>
                </tr>
                <tr>
                    <td><label>Registration date</label></td>
                    <td>
                        <p:calendar id="registrationDate" value="#{event.registrationDate}"/>
                    </td>
                </tr>
                <tr>
                    <td><label>Deadline date</label></td>
                    <td>
                        <p:calendar id="deadlineDate" value="#{event.deadlineDate}" showOn="button"/>
                    </td>
                </tr>
                <tr>
                    <td><label>Responsible company</label></td>
                    <td>
                        <p:autoComplete id="responsible" minQueryLength="2" value="#{company.name}"
                                        completeMethod="#{companyService.getCompanyNamesWhereNameLike}" effect="fade"/>
                     </td>
                </tr>
                <tr>
                    <td><label>Photos</label></td>
                    <td>
                        <ui:repeat value="#{event.photos}" var="photo">
                            <h:inputText value="#{photo}"/>
                            <br/>
                        </ui:repeat>
                        <h:commandButton value="Extend">
                            <f:ajax listener="#{event.extend}"
                                    process="@form"
                                    render="@form" />
                        </h:commandButton>
                    </td>
                </tr>
                <tr>
                    <td><label>Description</label></td>
                    <td><h:inputText id="description" value="#{event.description}"></h:inputText>
                    </td>
                </tr>
                <tr>
                    <td colspan="2"><h:commandButton action="#{eventService.addEvent(event, company)}"
                                                     value="Add Event"></h:commandButton>
                    </td>
                </tr>

            </table>

        </h:form>


        <br/>

        <h3>Persons List</h3>
        <br/>
        <c:if test="${!empty eventService.eventList}">
            <table class="tg">
                <tr>
                    <th>Event ID</th>
                    <th>Event State</th>
                    <th>Creation Date</th>
                    <th>Registration Date</th>
                    <th>Deadline Date</th>
                    <th>Responsible company</th>
                    <th>Description</th>
                    <th>Photos</th>
                </tr>
                <ui:repeat var="event" value="${eventService.eventList}">
                    <tr>
                        <td>${event.id}</td>
                        <td>${event.eventState}</td>
                        <td>${event.creationDate}</td>
                        <td>${event.registrationDate}</td>
                        <td>${event.deadlineDate}</td>
                        <td>${event.responsible.name}</td>
                        <td>${event.description}</td>
                        <td>
                            <c:if test="${empty event.photos}">
                                <table class="photos_inside">

                                        <ui:repeat var="photo" value="${event.photos}">
                                            <tr><td>${photo}</td></tr>
                                        </ui:repeat>

                                </table>
                            </c:if>
                        </td>
                    </tr>
                </ui:repeat>
            </table>
        </c:if>
    </f:view>
</h:body>
</html>
